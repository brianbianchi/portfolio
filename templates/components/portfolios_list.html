{% load humanize %}

{% if portfolios %}
<div class="table-responsive">
  <table class="table table-striped table-hover">
    <thead>
      <tr>
        <th scope="col">Name</th>
        <th scope="col">
          Value
          <span class="d-inline-block" tabindex="0" data-bs-toggle="popover" data-bs-trigger="hover focus"
            data-bs-content="Portfolio and asset values are updated once per day, after the markets
          have closed.">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-info-circle"
              viewBox="0 0 16 16">
              <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16" />
              <path
                d="m8.93 6.588-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533zM9 4.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0" />
            </svg>
          </span>
        </th>
        <th scope="col">Day change</th>
        <th scope="col">Total change</th>
        <th scope="col">Last updated</th>
        <th scope="col">Created</th>
      </tr>
    </thead>
    <tbody>
      {% for portfolio in portfolios %}
      <tr>
        <td>
          <a href="{% url 'view_portfolio' id=portfolio.id %}">
            {{portfolio.name}}
          </a>
        </td>
        <td>
          ${{portfolio.value|floatformat:2|intcomma}}
        </td>
        <td>
          {% if portfolio.day_change %}
          <span class="badge text-bg-{% if info.regularMarketChange >= 0 %}success{% else %}danger{% endif %}">
            {{portfolio.day_change|floatformat:2|intcomma}} ({{portfolio.day_perc_change|floatformat:2|intcomma}}%)
          </span>
          {% else %} - {% endif %}
        </td>
        <td>
          <span class="badge text-bg-{% if info.regularMarketChange >= 0 %}success{% else %}danger{% endif %}">
            {{portfolio.total_change|floatformat:2|intcomma}} ({{portfolio.total_perc_change|floatformat:2|intcomma}}%)
          </span>
        </td>
        <td>{{portfolio.last_updated|naturaltime}}</td>
        <td>{{portfolio.created|naturalday}}</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% include './pagination.html' with page=portfolios page_query=page_query %}
{% else %}
<p class="fst-italic fw-light">No portfolios found.</p>
{% endif %}